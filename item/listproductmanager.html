<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../responsive.css" />
    <link rel="stylesheet" href="listmanagerproduct.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="list-products grid wide">
      <p>Danh sách sản phẩm</p>
      <ul class="products">
        <li class="top-list">
          <ul>
            <li>#ID</li>
            <li>ẢNH</li>
            <li>TÊN SẢN PHẨM</li>
            <li>HÃNG ĐIỆN THOẠI</li>
            <li>GIÁ</li>
            <li></li>
          </ul>
        </li>
        <!-- <li class="item">
          <ul>
            <li>#ID</li>
            <li>
              <img
                src="https://cdn2.cellphones.com.vn/insecure/rs:fill:358:358/q:80/plain/https://cellphones.com.vn/media/catalog/product/_/7/_76666_7__3.jpg"
                alt=""
              />
            </li>
            <li>TÊN SẢN PHẨM</li>
            <li>THƯƠNG HIỆU</li>
            <li>
              <p class="price-show">100000000000</p>
              <p class="price-origin">GIÁ GỐC</p>
            </li>
            <li>
              <button type="submit" class="delete-product">X</button>
              <button type="submit" class="edit-product">SỬA</button>
            </li>
          </ul>
        </li>
        <li class="item">
          <ul>
            <li>#ID</li>
            <li>
              <img
                src="https://cdn2.cellphones.com.vn/insecure/rs:fill:358:358/q:80/plain/https://cellphones.com.vn/media/catalog/product/_/7/_76666_7__3.jpg"
                alt=""
              />
            </li>
            <li>TÊN SẢN PHẨM</li>
            <li>THƯƠNG HIỆU</li>
            <li>
              <p class="price-show">100000000000</p>
              <p class="price-origin">GIÁ GỐC</p>
            </li>
            <li>
              <button type="submit" class="delete-product">X</button>
              <button type="submit" class="edit-product">SỬA</button>
            </li>
          </ul>
        </li>
        <li class="item">
          <ul>
            <li>#ID</li>
            <li>
              <img
                src="https://cdn2.cellphones.com.vn/insecure/rs:fill:358:358/q:80/plain/https://cellphones.com.vn/media/catalog/product/_/7/_76666_7__3.jpg"
                alt=""
              />
            </li>
            <li>TÊN SẢN PHẨM</li>
            <li>THƯƠNG HIỆU</li>
            <li>
              <p class="price-show">100000000000</p>
              <p class="price-origin">GIÁ GỐC</p>
            </li>
            <li>
              <button type="submit" class="delete-product">X</button>
              <button type="submit" class="edit-product">SỬA</button>
            </li>
          </ul>
        </li>
        <li class="item">
          <ul>
            <li>#ID</li>
            <li>
              <img
                src="https://cdn2.cellphones.com.vn/insecure/rs:fill:358:358/q:80/plain/https://cellphones.com.vn/media/catalog/product/_/7/_76666_7__3.jpg"
                alt=""
              />
            </li>
            <li>TÊN SẢN PHẨM</li>
            <li>THƯƠNG HIỆU</li>
            <li>
              <p class="price-show">100000000000</p>
              <p class="price-origin">GIÁ GỐC</p>
            </li>
            <li>
              <button type="submit" class="delete-product">X</button>
              <button type="submit" class="edit-product">SỬA</button>
            </li>
          </ul> -->
        <!-- </li> -->
      </ul>
      <ul class="list-page"></ul>
    </div>
  </body>
  <script>
    let products = JSON.parse(localStorage.getItem("json-products"));
    console.log(products);
    for (let i = 0; i < products.length; i++) {
      document.querySelector(".products").innerHTML += showProducts(
        products[i]
      );
    }
    function showProducts(item) {
      return `<li class="item">
          <ul>
            <li>#ID</li>
            <li>
              <img
                src="${item.img}"
                alt=""
              />
            </li>
            <li>${item.title}</li>
            <li>${item.brand}</li>
            <li>
              <p class="price-show">${price_format(item.price_show)}</p>
              <p class="price-origin">${price_format(item.price_origin)}</p>
            </li>
            <li>
              <button type="submit" class="delete-product">X</button>
              <button type="submit" class="edit-product">SỬA</button>
            </li>
          </ul>
        </li>`;
    }
    let limit = 12;
    let thisPage = 1;
    let list = document.querySelectorAll(".products .item");
    loadItem();
    function loadItem() {
      let beginIndex = limit * (thisPage - 1);
      let endIndex = limit * thisPage - 1;
      for (let i = 0; i < list.length; i++) {
        if (i >= beginIndex && i <= endIndex) list[i].style.display = "block";
        else list[i].style.display = "none";
      }
      listPage();
    }
    function listPage() {
      let count = Math.ceil(list.length / limit);
      document.querySelector(".list-page").innerHTML = "";
      if (thisPage != 1) {
        let prev = document.createElement("li");
        prev.innerText = "Trước";
        prev.setAttribute("onclick", "changePage(" + (thisPage - 1) + ")");
        document.querySelector(".list-page").appendChild(prev);
      }
      for (let i = 1; i <= count; i++) {
        let newPage = document.createElement("li");
        newPage.innerText = i;
        if (i == thisPage) {
          newPage.classList.add("page-current");
        }
        newPage.setAttribute("onclick", "changePage(" + i + ")");
        document.querySelector(".list-page").appendChild(newPage);
      }
      if (thisPage != count) {
        let next = document.createElement("li");
        next.innerText = "Sau";
        next.setAttribute("onclick", "changePage(" + (thisPage + 1) + ")");
        document.querySelector(".list-page").appendChild(next);
      }
    }
    function changePage(i) {
      thisPage = i;
      loadItem();
    }
    function price_format(price) {
      if (price == "") return "";
      let price_str = "";
      let tmp = price;
      for (i = price.length; i > 3; i -= 3) {
        price_str = "." + tmp.slice(-3) + price_str;
        tmp = tmp.substr(0, i - 3);
      }
      tmp = tmp.slice(0);
      return tmp + price_str + "₫";
    }
  </script>
</html>
